%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Convert quarterly data into monthly
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Written by Katherine Dai
% Date: Sept 5, 2024

clc;
clear all

% Prepare your data in excel first
% Three columns in the excel file: x - quarters; y - gdp value/ price... ;
% xx - months

%% Copy paste your quarters here (1: 1st Quarter; 4: 2nd Quarter ...)
x = [1
4
7
10
13
16
19
22
25
28
31
34
37
40
43
46
49
52
55
58
61
64
67
70
73
76
79
82
85
88
91
94
97
100
103
106
109
112
115
118
121
124
127
130
133
136
139
142
145
148
151
154
157
160
163
166
169
172
175
178
181
184
187
190
193
196
199
202
205
208
211
214
217
220
223
226
229
232
235
238
241
244
247
250
253
256
259
262
265
268
271
274
277
280
283
286
289
292
295
298
301
304
307];

%% copy paste quarterly gdp
y = [2121053.1
2142704.2
2154130.3
2179952.0
2204458.2
2232966.3
2252621.1
2266007.8
2279867.3
2303250.2
2305246.2
2308266.5
2308289.1
2312641.4
2325098.8
2334400.9
2338687.2
2332860.4
2333829.7
2348268.2
2364056.4
2376380.4
2390498.0
2396538.7
2406441.4
2411361.9
2426722.2
2446185.3
2461372.6
2482669.1
2511906.7
2527177.7
2556032.2
2572414.7
2591368.9
2602209.7
2615099.2
2631140.1
2620629.2
2606387.5
2559672.9
2481301.3
2479702.4
2488424.1
2500594.3
2510436.5
2535227.5
2545994.9
2560584.2
2585049.5
2585591.7
2588050.7
2578138.3
2572048.4
2563772.6
2561243.5
2550924.3
2541755.2
2557506.4
2565495.6
2573691.5
2583869.5
2589207.9
2601216.0
2610549.7
2626626.5
2639783.9
2650329.3
2663342.1
2676504.4
2683871.7
2695289.2
2715216.5
2735859.9
2756585.4
2777208.3
2798453.1
2798430.9
2811897.4
2812337.3
2831760.1
2851080.0
2860671.5
2865372.1
2865443.6
2769595.8
2461329.4
2748729.2
2752932.8
2764433.0
2827760.5
2884931.5
2901716.6
2918981.2
2944906.1
2958150.3
2956022.5
2956250.8
2960200.7
2961415.3
2961562.6
2969901.4
2978872.7];

%% Consecutive months. The last number should be equal to the last element of x
xx = [1:307]';

yy = spline(x, y, xx);
%% Merge
max_len = max([length(x), length(y), length(xx), length(yy)]);

x_p = cell(max_len, 1);
y_p = cell(max_len, 1);
xx_p = cell(max_len, 1);
yy_p = cell(max_len, 1);

x_p(1:length(x)) = num2cell(x);
y_p(1:length(y)) = num2cell(y);
xx_p(1:length(xx)) = num2cell(xx);
yy_p(1:length(yy)) = num2cell(yy);

%% Export
T = table(x_p, y_p, xx_p, yy_p, 'VariableNames', {'quarter', 'quarterly_data', 'month', 'monthly_data'})
writetable(T, 'monthlyoutput.xlsx');
